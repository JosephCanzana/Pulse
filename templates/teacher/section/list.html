{% set page_title = "My Sections" %}
{% extends "layout.html" %}

{% block title %}
  Manage Sections
{% endblock %}

{% block main %}
<section class="w-full h-full space-y-6 text-[var(--clr-txt-primary)] transition-all duration-300">

  <!-- Header -->
  <div class="flex flex-wrap items-center justify-between">
    <h1 class="text-2xl font-bold text-[var(--clr-primary)]">My Advisory Sections</h1>
  </div>

  <!-- Table Container -->
  <div class="overflow-x-auto bg-[var(--clr-surface)] dark:bg-[var(--clr-surface-alt)] rounded-2xl shadow-md border border-[var(--clr-border)]">
    <table class="min-w-full text-sm text-left border-collapse">
      <thead class="bg-[var(--clr-primary)] text-white">
        <tr>
          <th class="px-5 py-3 font-semibold">Section</th>
          <th class="px-5 py-3 font-semibold">Course</th>
          <th class="px-5 py-3 font-semibold">Year Level</th>
          <th class="px-5 py-3 font-semibold">Education Level</th>
          <th class="px-5 py-3 font-semibold">Academic Year</th>
          <th class="px-5 py-3 font-semibold text-center">Students</th>
          <th class="px-5 py-3 font-semibold text-center">Status</th>
          <th class="px-5 py-3 font-semibold text-center">Actions</th>
        </tr>
      </thead>
      <tbody class="divide-y divide-[var(--clr-border-strong)]">
        {% for section in sections %}
        <tr class="hover:bg-[var(--clr-glass-light)] dark:hover:bg-[var(--clr-glass-dark)] transition-all duration-200">
          <td class="px-5 py-3 font-medium">{{ section.section_name }}</td>
          <td class="px-5 py-3">{{ section.course_name or '—' }}</td>
          <td class="px-5 py-3">{{ section.year_level or '—' }}</td>
          <td class="px-5 py-3">{{ section.education_level or '—' }}</td>
          <td class="px-5 py-3">{{ section.academic_year }}</td>
          <td class="px-5 py-3 text-center">{{ section.student_count }}</td>
          <td class="px-5 py-3 text-center">
            {% if section.status %}
              <span class="px-3 py-1 text-xs font-semibold bg-[var(--clr-success)]/20 text-[var(--clr-success)] rounded-full">Active</span>
            {% else %}
              <span class="px-3 py-1 text-xs font-semibold bg-[var(--clr-error)]/20 text-[var(--clr-error)] rounded-full">Archived</span>
            {% endif %}
          </td>
          <td class="px-5 py-3 text-center flex justify-center items-center gap-2">

            <!-- Edit Button -->
            <a href="{{ url_for('teacher.edit_section', section_id=section.section_id) }}"
               class="flex items-center justify-center px-3 py-1 rounded-lg bg-[var(--clr-glass-light)] dark:bg-[var(--clr-glass-dark)] hover:bg-[var(--clr-glow-primary)] text-[var(--clr-primary)] hover:text-white shadow transition-all duration-200">
               <span class="material-symbols-outlined text-sm">edit</span>
            </a>

            <!-- Archive / Activate Button -->
            <form action="{{ url_for('teacher.toggle_section_status', section_id=section.section_id) }}" method="POST" class="inline">
              <button type="submit"
                      class="flex items-center justify-center px-3 py-1 rounded-lg bg-[var(--clr-glass-light)] dark:bg-[var(--clr-glass-dark)] hover:bg-[var(--clr-warning)] text-[var(--clr-warning)] hover:text-white shadow transition-all duration-200">
                <span class="material-symbols-outlined text-sm">archive</span>
              </button>
            </form>

            <!-- View Button -->
            <a href="{{ url_for('teacher.section_manage_students', section_id=section.section_id) }}"
               class="flex items-center justify-center px-3 py-1 rounded-lg bg-[var(--clr-glass-light)] dark:bg-[var(--clr-glass-dark)] hover:bg-[var(--clr-glow-tertiary)] text-[var(--clr-tertiary)] hover:text-white shadow transition-all duration-200">
               <span class="material-symbols-outlined text-sm">visibility</span>
            </a>

          </td>
        </tr>
        {% else %}
        <tr>
          <td colspan="8" class="text-center py-6 text-[var(--clr-txt-muted)]">
            No sections found.
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</section>
{% endblock %}
