{% extends "layout.html" %}
  
{% block title %}
  Student List
{% endblock %}

{% block main %}
<div class="flex flex-col items-center justify-center">
  <a href="{{ url_for('admin_student_add') }}" 
     class="m-2 rounded-full border border-blue-600 px-4 py-2 hover:bg-blue-600 hover:text-white transition">
     Add Student
  </a>

  <h1 class="m-2 text-xl font-semibold">Student List</h1>

  <table class="border-collapse border border-gray-400 text-sm w-full max-w-6xl">
    <thead class="bg-gray-100">
      <tr>
        <th class="border px-3 py-2">Name</th>
        <th class="border px-3 py-2">Email</th>
        <th class="border px-3 py-2">School ID</th>
        <th class="border px-3 py-2">Education Level</th>
        <th class="border px-3 py-2">Course</th>
        <th class="border px-3 py-2">Section</th>
        <th class="border px-3 py-2">Year</th>
        <th class="border px-3 py-2">Account Status</th>
        <th class="border px-3 py-2 text-center">Actions</th>
      </tr>
    </thead>

    <tbody>
      {% for s in students %}
      <tr class="hover:bg-gray-50 transition">
        <td class="border px-3 py-2">{{ s.first_name }} {{ s.last_name }}</td>
        <td class="border px-3 py-2">{{ s.email }}</td>
        <td class="border px-3 py-2">{{ s.school_id }}</td>
        <td class="border px-3 py-2">{{ s.education_level_name or 'N/A' }}</td>
        <td class="border px-3 py-2">{{ s.course_name or 'N/A' }}</td>
        <td class="border px-3 py-2">{{ s.section_name or 'N/A' }}</td>
        <td class="border px-3 py-2">{{ s.academic_year_name or 'N/A' }}</td>
        <td class="border px-3 py-2 text-center">
          {% if s.is_verified %}
            <span class="text-green-600 font-medium">Activated</span>
          {% else %}
            <span class="text-red-600 font-medium">Not Activated</span>
          {% endif %}
        </td>

        <td class="border px-3 py-2 text-center">
          <!-- Edit -->
          <a href="{{ url_for('admin_student_edit', school_id=s.school_id) }}" 
             class="text-blue-600 hover:text-blue-800 font-medium mr-2">
            Edit
          </a>

          <!-- Delete -->
          <form action="{{ url_for('admin_delete') }}" 
                method="POST" 
                class="inline"
                onsubmit="return openConfirmFormModal(event, this, 'Delete Student', 'Are you sure you want to delete this student?')">
            <input type="hidden" name="id" value="{{ s.user_id }}">
            <input type="hidden" name="table" value="Users">
            <button type="submit" class="text-red-600 hover:text-red-800 font-medium">
              Delete
            </button>
          </form>
          
          <form action="{{ url_for('admin_reset') }}" 
                method="POST" 
                class="inline"
                onsubmit="return openConfirmFormModal(event, this, 'Reset Student Sccount', 'Are you sure you want to reset password of this student?')">
            <input type="hidden" name="id" value="{{ s.user_id }}">
            <input type="hidden" name="table" value="Users">
            <button type="submit" class="text-red-600 hover:text-red-800 font-medium">
              Reset
            </button>
          </form>
          
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>
{% endblock %}
